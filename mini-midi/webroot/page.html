<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>FF7 Musical Interface - Reddit Edition</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Reddit-specific header -->
    <div class="reddit-header p-2 bg-primary text-white">
        <div class="d-flex justify-content-between align-items-center">
            <span>üéµ FF7 Musical Interface</span>
            <div class="btn-group btn-group-sm">
                <button id="saveBtn" class="btn btn-light btn-sm">Save</button>
                <button id="shareBtn" class="btn btn-light btn-sm">Share</button>
                <button id="collaborateBtn" class="btn btn-light btn-sm">Collaborate</button>
            </div>
        </div>
    </div>

    <!-- Recording controls -->
    <div class="recording-controls p-2 bg-light">
        <div class="d-flex justify-content-center align-items-center gap-2">
            <button id="recordBtn" class="btn btn-danger btn-sm">‚óè Record</button>
            <button id="playBtn" class="btn btn-success btn-sm">‚ñ∂ Play</button>
            <button id="stopBtn" class="btn btn-secondary btn-sm">‚èπ Stop</button>
            <span id="recordingTime" class="badge bg-secondary">00:00</span>
        </div>
    </div>

    <!-- Mobile rotation message -->
    <div id="rotate-device" class="d-flex flex-column col-lg-12 mx-0 py-md-1 flex-grow-1" style="display: none;">
        <div class="d-flex align-self-center mx-auto flex-grow-1">
            <div class="text-center align-self-center">
                Please rotate your device to landscape mode.
                <br />
                <img alt="rotate screen" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTI1IDEwVjE1TTI1IDM1VjQwTTEwIDI1SDE1TTM1IDI1SDQwTTE3LjY3NzcgMTcuNjc3N0wyMS4yMTMyIDIxLjIxMzJNMjguNzg2OCAyOC43ODY4TDMyLjMyMjMgMzIuMzIyMyIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K" width="50" height="50" />
            </div>
        </div>
    </div>

    <!-- Main application -->
    <div class="d-flex flex-column col-lg-12 mx-0 py-md-1 flex-grow-1" id="app">
        <main class="flex-grow-1">
            <div class="main container text-center" id="startMessage">
                <p>üéÆ Use your gamepad, touch, or mouse to create music inspired by FF7 Rebirth!</p>
                <p>üéµ Record your compositions and share them with the Reddit community!</p>
                <button id="startAudioContext" class="btn-primary btn">Start Playing!</button>
            </div>

            <div class="main align-items-center" id="player-div" style="display: none;">
                <div class="container">
                    <div class="row">
                        <select id="languages" aria-label="Pick your language" class="form-select ml-auto">
                            <option value="en" selected>English</option>
                            <option value="fr">Fran√ßais</option>
                            <option value="es">Castellano</option>
                        </select>
                    </div>

                    <!-- Left controls -->
                    <div class="row">
                        <div class="col-3 ps-0">
                            <div class="tone-button" id="left_tone_1">
                                <img id="button_up" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTI1IDEwTDM1IDMwSDM1TDI1IDEwWk0yNSAxMEwxNSAzMEgzNUwyNSAxMFoiIGZpbGw9IiMwMDAiLz4KPC9zdmc+Cg==" alt="up" class="img-gamepad-button" />
                                <span id="tons_label">Tons</span>
                            </div>
                            <div class="tone-button" id="left_tone_2">
                                <img id="button_lt" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMjUiIGZpbGw9IiMwMDAiLz4KPHR5cGU+TFQ8L3RleHQ+Cjwvc3ZnPgo=" alt="lt" class="img-gamepad-button" />
                                <span id="left_semitones_label">Semitones</span>
                            </div>
                            <div class="tone-button" id="left_tone_3">
                                <img id="button_lb" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMjUiIGZpbGw9IiMwMDAiLz4KPHR5cGU+TDwvdGV4dD4KPC9zdmc+Cg==" alt="lb" class="img-gamepad-button" />
                                <span id="minor_label">Minor</span>
                            </div>
                        </div>

                        <!-- Left instrument -->
                        <div class="col-3">
                            <div class="outer mx-auto" id="leftInstrument">
                                <div class="line line0"></div>
                                <div class="line line1"></div>
                                <div class="line line2"></div>
                                <div class="line line3"></div>
                                <div id="left_note_0" class="note_0"></div>
                                <div id="left_note_1" class="note_1"></div>
                                <div id="left_note_2" class="note_2"></div>
                                <div id="left_note_3" class="note_3"></div>
                                <div id="left_note_4" class="note_4">L</div>
                                <div id="left_note_5" class="note_5"></div>
                                <div id="left_note_6" class="note_6"></div>
                                <div id="left_note_7" class="note_7"></div>
                                <div class="mid">
                                    <div class="inner" id="leftAxis">L</div>
                                </div>
                            </div>
                        </div>

                        <!-- Right instrument -->
                        <div class="col-3">
                            <div class="outer mx-auto" id="rightInstrument">
                                <div class="line line0"></div>
                                <div class="line line1"></div>
                                <div class="line line2"></div>
                                <div class="line line3"></div>
                                <div id="right_note_0" class="note_0"></div>
                                <div id="right_note_1" class="note_1"></div>
                                <div id="right_note_2" class="note_2"></div>
                                <div id="right_note_3" class="note_3"></div>
                                <div id="right_note_4" class="note_4"></div>
                                <div id="right_note_5" class="note_5"></div>
                                <div id="right_note_6" class="note_6"></div>
                                <div id="right_note_7" class="note_7"></div>
                                <div class="mid">
                                    <div class="inner" id="rightAxis">R</div>
                                </div>
                            </div>
                        </div>

                        <!-- Right controls -->
                        <div class="col-3 pe-0">
                            <div class="tone-button" id="right_tone_1">
                                <img id="button_rt" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMjUiIGZpbGw9IiMwMDAiLz4KPHR5cGU+UlQ8L3RleHQ+Cjwvc3ZnPgo=" alt="rt" class="img-gamepad-button" />
                                <span id="right_semitones_label">Semitones</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bottom controls -->
                    <div class="row">
                        <!-- Chord controls -->
                        <div class="col-6 align-self-center">
                            <p id="octaveLabel" class="text-center mt-3 mb-0 label">
                                <span id="change_chord_label">Change chord</span>
                            </p>
                            <div class="octave-button mb-0">
                                <div class="circle-btn" id="chordDown">
                                    <img id="button_left" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMwIDEwTDEwIDI1TDMwIDQwViIgZmlsbD0iIzAwMCIvPgo8L3N2Zz4K" alt="left" style="transform: rotate(-90deg);" class="img-gamepad-button" />
                                </div>
                                <div id="chord-bullet-0" class="octave-bullet"></div>
                                <div id="chord-bullet-1" class="octave-bullet"></div>
                                <div id="chord-bullet-2" class="octave-bullet"></div>
                                <div id="chord-bullet-3" class="octave-bullet"></div>
                                <div id="chord-bullet-4" class="octave-bullet"></div>
                                <div id="chord-bullet-5" class="octave-bullet"></div>
                                <div id="chord-bullet-6" class="octave-bullet"></div>
                                <div id="chord-bullet-7" class="octave-bullet"></div>
                                <div id="chord-bullet-8" class="octave-bullet"></div>
                                <div class="circle-btn" id="chordUp">
                                    <img id="button_right" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIwIDEwTDQwIDI1TDIwIDQwViIgZmlsbD0iIzAwMCIvPgo8L3N2Zz4K" alt="right" style="transform: rotate(90deg);" class="img-gamepad-button" />
                                </div>
                            </div>
                            <div class="octave-button">
                                <div class="circle-btn" id="chordInit">
                                    <img id="button_down" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDIwTDI1IDQwTDQwIDIwSCIgZmlsbD0iIzAwMCIvPgo8L3N2Zz4K" alt="down" style="transform: rotate(180deg);" class="img-gamepad-button" />
                                </div>
                                <div class="label">
                                    <span id="reinitialize_chord_label">Reinitialize chord</span>
                                </div>
                            </div>
                        </div>

                        <!-- Octave controls -->
                        <div class="col-6 align-self-center">
                            <div class="octaves">
                                <p id="octaveLabel" class="text-center mt-3 mb-0 label">
                                    <span id="change_octave_label">Change octave</span>
                                </p>
                                <div class="octave-button mb-0">
                                    <div class="circle-btn" id="octaveDown">
                                        <img id="button_x" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjAiIGZpbGw9IiMwMDAiLz4KPHR5cGU+WDwvdGV4dD4KPC9zdmc+Cg==" alt="x" class="img-gamepad-button" />
                                    </div>
                                    <div id="octave-bullet-0" class="octave-bullet"></div>
                                    <div id="octave-bullet-1" class="octave-bullet"></div>
                                    <div id="octave-bullet-2" class="octave-bullet"></div>
                                    <div id="octave-bullet-3" class="octave-bullet"></div>
                                    <div id="octave-bullet-4" class="octave-bullet"></div>
                                    <div id="octave-bullet-5" class="octave-bullet"></div>
                                    <div class="circle-btn" id="octaveUp">
                                        <img id="button_b" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjAiIGZpbGw9IiNGRkYiLz4KPHR5cGU+QjwvdGV4dD4KPC9zdmc+Cg==" alt="b" class="img-gamepad-button" />
                                    </div>
                                </div>
                                <div class="octave-button">
                                    <div class="circle-btn" id="octaveInit">
                                        <img id="button_a" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjAiIGZpbGw9IiMwMDAiLz4KPHR5cGU+QTwvdGV4dD4KPC9zdmc+Cg==" alt="a" class="img-gamepad-button" />
                                    </div>
                                    <div class="label">
                                        <span id="reinitialize_octave_label">Reinitialize octave</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Reddit integration modals -->
    <div class="modal fade" id="shareModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Share Your Composition</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <textarea id="shareMessage" class="form-control" rows="3" placeholder="Add a message about your composition..."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirmShare">Share to Comments</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark-subtle p-2 fs-6">
        <div class="container">
            <div class="text-center">
                <p class="text-muted small">FF7 Musical UI for Reddit - Create and share music with the community!</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src='https://surikov.github.io/webaudiofont/npm/dist/WebAudioFontPlayer.js'></script>
    <script src='https://surikov.github.io/webaudiofontdata/sound/0000_Chaos_sf2_file.js'></script>
    <script src='scripts/i18n/en.js'></script>
    <script src='scripts/i18n/es.js'></script>
    <script src='scripts/i18n/fr.js'></script>
    <script src="scripts/redditApp.js" defer type="module"></script>
</body>
</html>